(()=>{"use strict";const e="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRhamZ6cWtxb2hnYWhvYW1lZmdpIiwicm9sZSI6ImFub24iLCJpYXQiOjE2NzA5ODIyOTksImV4cCI6MTk4NjU1ODI5OX0.MIof23JM1j2NZEat7zDUgYtoEYKkqlsI9D86qG71aRo",n="https://tajfzqkqohgahoamefgi.supabase.co",a={apiKey:e,"Content-Type":"application/json"};async function t(e,n,a,t){let l=await fetch(e,{method:n,headers:a,body:JSON.stringify(t)});return 200==l.status&&l.status<=300?l.headers.get("content-type")?await l.json():{}:Promise.reject(await l.json())}async function l(e,l){let o=`${n}/rest/v1/${e}`,s={...a,Authorization:"Bearer "+l};return await t(o,"get",s)}function o(e){return Math.floor(Date.now()/1e3)+e}function s(){return!!(localStorage.getItem("access_token")&&localStorage.getItem("expirationDate")>Math.floor(Date.now()/1e3))}function r(){(async function(e){let l=`${n}/auth/v1/logout`,o={...a,Authorization:"Bearer "+e};return await t(l,"post",o,{})})(localStorage.getItem("access_token")).then((e=>{console.log(e),localStorage.removeItem("access_token")}))}async function i(){let n=localStorage.getItem("access_token"),a=localStorage.getItem("uid"),t=await l(`profiles?id=eq.${a}&select=*`,n);console.log(t);let o=t[0].avatar_url;if(t[0].avatar_blob=!1,o){let a=await async function(n,a){const t={apiKey:e,Authorization:`Bearer ${a}`};let l=await fetch(`${n}`,{method:"GET",headers:t});return l.status>=200&&l.status<=300?l.headers.get("content-type")?await l.blob():{}:Promise.reject(await l.json())}(o,n);console.log(a),a instanceof Blob&&(t[0].avatar_blob=URL.createObjectURL(a))}return t}function c(){let l=document.createElement("div");return l.classList.add("formulari_centrat"),i().then((o=>{o=o[0],console.log(o),l.innerHTML=`<form action="action_page.php" id="formProfile" style="border: 1px solid #ccc">\n    <div class="container">\n      <h1>Profile</h1>\n      \n      <hr />\n\n      <label for="email"><b>Email</b></label>\n      <input\n        id="signupemail"\n        type="text"\n        placeholder="Enter Email"\n        name="email"\n        required\n        readonly\n        value="${localStorage.getItem("mail")}"\n      />\n\n      <label for="psw"><b>Password</b></label>\n      <input\n        type="password"\n        id="signuppassword"\n        placeholder="Enter Password"\n        name="psw"\n        required\n      />\n\n      <label for="psw-repeat"><b>Repeat Password</b></label>\n      <input\n        type="password"\n        placeholder="Repeat Password"\n        name="psw-repeat"\n        required\n      />\n      <button type="button" class="signupbtn login" id="chgpass">Change Password</button>\n\n      <label for="username"><b>Username</b></label>\n      <input\n        type="text"\n        placeholder="user name"\n        name="username"\n        id = "username"\n        value = "${o.username}"\n      />\n\n      <label for="fullname"><b>Full Name</b></label>\n      <input\n        type="text"\n        placeholder="fullname"\n        name="full_name"\n        value = "${o.full_name}"\n      />\n\n\n      <label for="web"><b>Web Site</b></label>\n      <input\n        type="text"\n        placeholder="web"\n        name="website"\n        value = "${o.website}"\n      />\n  <div>\n      <img class="avatar_profile" id="avatar_prev" src="${o.avatar_blob?o.avatar_blob:""}"/>\n</div>\n      <label for="avatar"><b>Avatar</b></label>\n      <input\n        type="file"\n        id="avatar"\n        name="avatar"\n      />\n  \n\n      <div class="clearfix">\n\n        <button type="button" class="signupbtn login" id="update">Update Profile</button>\n      </div>\n    </div>\n  </form>`,l.querySelector("#update").addEventListener("click",(async()=>{let o=new FormData(l.querySelector("#formProfile")),{username:s,full_name:r,website:i,avatar:c}=Object.fromEntries(o);console.log({username:s,full_name:r,website:i,avatar:c}),await async function(l){let o=localStorage.getItem("access_token"),s=localStorage.getItem("uid"),r=new FormData;r.append("avatar",l.avatar,"avatarProfile.png"),console.log(r);let i=await async function(a,t,l){const o={apiKey:e,Authorization:`Bearer ${l}`,"x-upsert":!0};let s=await fetch(`${n}${a}`,{method:"POST",headers:o,body:t});if(s.status>=200&&s.status<=300){if(s.headers.get("content-type")){let e=await s.json();return e.urlAvatar=`${n}${a}`,e}return{}}return Promise.reject(await s.json())}(`/storage/v1/object/avatars/avatar${s}.png`,r,o);l.avatar_url=i.urlAvatar,delete l.avatar,await async function(e,l,o){let s=`${n}/rest/v1/${e}`,r={...a,Authorization:"Bearer "+l,Prefer:"return=representation"};return await t(s,"PATCH",r,o)}(`profiles?id=eq.${s}&select=*`,o,l)}({username:s,full_name:r,website:i,avatar:c}),d("#/profile")})),l.querySelector("#avatar").addEventListener("change",(function(){!function(e){let n=e.files[0];n&&(l.querySelector("#avatar_prev").src=URL.createObjectURL(n))}(this)}))})),l}function d(e){console.log(e);let s=document.querySelector("#main");if(/#\/graph\/[0-9]+/.test(e))e.split("/")[2],s.innerHTML="",s.append(function(e){let n=document.createElement("div");return n.classList.add(""),n}());else if(/#access_token=.*type=recovery$/.test(e)){let n=Object.fromEntries(e.substring(1).split("&").map((e=>e.split("="))));i=n.access_token,d=n.expires_in,localStorage.setItem("access_token",i),localStorage.setItem("expirationDate",o(d)),window.location.hash="#/"}else switch(e){case"#/":s.innerHTML="",s.append(document.createElement("div"));break;case"#/login":s.innerHTML="",s.append(function(){let e=document.createElement("div");return e.classList.add("formulari_centrat"),e.innerHTML='\n  <form action="action_page.php" method="post">\n  <section class="vh-100" style="background-color: #508bfc;">\n  <div class="container py-5 h-100">\n    <div class="row d-flex justify-content-center align-items-center h-100">\n      <div class="col-12 col-md-8 col-lg-6 col-xl-5">\n        <div class="card shadow-2-strong" style="border-radius: 1rem;">\n          <div class="card-body p-5 text-center">\n\n            <h3 class="mb-5">Sign in</h3>\n\n            <div class="form-outline mb-4">\n              <input type="text" id="loginemail" class="form-control form-control-lg" name="uname" required />\n              <label class="form-label" for="uname">Email</label>\n            </div>\n\n            <div class="form-outline mb-4">\n              <input type="password" id="loginpassword" class="form-control form-control-lg" name="psw" required />\n              <label class="form-label" for="psw">Password</label>\n            </div>\n\n            <button id="loginbutton" class="login" class="btn btn-primary btn-lg btn-block" type="button">Login</button>\n            <label>\n                <input type="checkbox" checked="checked" name="remember" /> Remember me\n            </label>\n            \n            <hr class="my-4">\n\n            <button class="btn btn-lg btn-block btn-primary" style="background-color: #dd4b39;"\n              type="submit"><i class="fab fa-google me-2"></i> Sign in with google</button>\n            <button class="btn btn-lg btn-block btn-primary mb-2" style="background-color: #3b5998;"\n              type="submit"><i class="fab fa-facebook-f me-2"></i>Sign in with facebook</button>\n\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</section>\n</form>',e.querySelector("#loginbutton").addEventListener("click",(async()=>{(async function(e,l){let s={success:!1};try{let r=await async function(e,l){let o=`${n}/auth/v1/token?grant_type=password`;return await t(o,"post",a,{email:e,password:l})}(e,l);console.log(r),localStorage.setItem("access_token",r.access_token),localStorage.setItem("expirationDate",o(r.expires_in)),s.success=!0}catch(e){console.log(e),s.success=!1,s.errorText=e.error_description}return s})(e.querySelector("#loginemail").value,e.querySelector("#loginpassword").value).then((n=>{n.success?window.location.hash="#/":e.querySelector("#errors").innerHTML=n.errorText}))})),e.querySelector("#logoutbtn").addEventListener("click",(()=>{r()})),e.querySelector("#forgot").addEventListener("click",(l=>{l.preventDefault(),async function(e){let l=await async function(e){let l=`${n}/auth/v1/recover`,o={...a};return await t(l,"post",o,{email:e})}(e);console.log(l)}(e.querySelector("#loginemail").value),l.target.parentElement.append(" Has rebut un correu")})),e}());break;case"#/data":s.innerHTML="",s.append(function(){let e=document.createElement("div");return e.classList.add("row","gx-2","gy-2","row-cols-1"),localStorage.getItem("access_token")?l("graphs",localStorage.getItem("access_token")).then((n=>{console.log(n);for(let a of n)e.append(generateTable(a))})):e.innerHTML="<p>Please, login<p>",e}());break;case"#/register":s.innerHTML="",s.append(function(){let e=document.createElement("div");return e.classList.add("formulari_centrat"),e.innerHTML='        \n  <form action="action_page.php" style="border: 1px solid #ccc">\n    <div class="container">\n      <h1>Sign Up</h1>\n      <p>Please fill in this form to create an account.</p>\n      <hr />\n\n      <label for="email"><b>Email</b></label>\n      <input\n        id="signupemail"\n        type="text"\n        placeholder="Enter Email"\n        name="email"\n        required\n      />\n\n      <label for="psw"><b>Password</b></label>\n      <input\n        type="password"\n        id="signuppassword"\n        placeholder="Enter Password"\n        name="psw"\n        required\n      />\n\n      <label for="psw-repeat"><b>Repeat Password</b></label>\n      <input\n        type="password"\n        placeholder="Repeat Password"\n        name="psw-repeat"\n        required\n      />\n\n      <label>\n        <input\n          type="checkbox"\n          checked="checked"\n          name="remember"\n          style="margin-bottom: 15px"\n        />\n        Remember me\n      </label>\n\n      <p>\n        By creating an account you agree to our\n        <a href="#" style="color: dodgerblue">Terms & Privacy</a>.\n      </p>\n\n      <div class="clearfix">\n        <button type="button" class="cancelbtn login">Cancel</button>\n        <button type="button" class="signupbtn login" id="signupbtn">Sign Up</button>\n      </div>\n    </div>\n  </form>',e.querySelector("#signupbtn").addEventListener("click",(async()=>{let l=e.querySelector("#signupemail").value,o=e.querySelector("#signuppassword").value,s=await function(e,l){let o={success:!1};try{(async function(e,l){let o=`${n}/auth/v1/signup`;return await t(o,"post",a,{email:e,password:l})})(e,l).then((e=>{console.log(e),o.success=!0}))}catch(e){console.log(e),o.success=!1,o.errorText=e.error_description}return o}(l,o);console.log(s)})),e}());break;case"#/logout":r(),window.location.hash="#/";break;case"#/profile":s.innerHTML="",s.append(c());break;case"":window.location.hash="#/"}var i,d}document.addEventListener("DOMContentLoaded",(()=>{let e=document.querySelector("#container");e.append(function(){let e=document.createElement("div");return e.id="header",e.classList.add("container"),e.innerHTML=`<nav class="navbar navbar-expand-lg">\n<div class="container">\n    <a class="navbar-brand text-white" href="#"><i class="fa fa-graduation-cap fa-lg mr-2"></i>CINEMA</a>\n    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#nvbCollapse" aria-controls="nvbCollapse">\n        <span class="navbar-toggler-icon"></span>\n    </button>\n    <div class="collapse navbar-collapse" id="nvbCollapse">\n        <ul class="navbar-nav ml-auto">\n            <li class="nav-item pl-1">\n                <a class="nav-link" href="#">\n                    <i class="fa fa-home fa-fw mr-1">\n                    </i>Peliculas</a>\n            </li>\n            <li class="nav-item active pl-1">\n                <a class="nav-link" href="#"><i class="fa fa-th-list fa-fw mr-1"></i>Catalogo</a>\n            </li>\n            <li class="nav-item pl-1">\n                <li class="nav-item dropdown">\n                    <a class="nav-link dropdown-toggle" data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false">Genero</a>\n                    <ul class="dropdown-menu">\n                        <li><a class="dropdown-item" href="#scrollspyHeading3">Acción</a></li>\n                        <li><a class="dropdown-item" href="#scrollspyHeading4">Aventura</a></li>\n                        <li><a class="dropdown-item" href="#scrollspyHeading5">Terror</a></li>\n                        <li><a class="dropdown-item" href="#scrollspyHeading6">Ciencia Ficción</a></li>\n                        <li><a class="dropdown-item" href="#scrollspyHeading7">Romantica</a></li>\n                        <li><a class="dropdown-item" href="#scrollspyHeading8">Comedia</a></li>\n                    </ul>\n                </li>\n            </li>\n            <li class="nav-item pl-1">\n                <li class="nav-item dropdown">\n                <a class="nav-link dropdown-toggle" data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false">Plataforma</a>\n                    <ul class="dropdown-menu">\n                        <li><a class="dropdown-item" href="#scrollspyHeading3">NETFLIX</a></li>\n                        <li><a class="dropdown-item" href="#scrollspyHeading4">HBO</a></li>\n                        <li><a class="dropdown-item" href="#scrollspyHeading5">AMAZON</a></li>\n                        <li><a class="dropdown-item" href="#scrollspyHeading6">DAZAN</a></li>\n                        <li><a class="dropdown-item" href="#scrollspyHeading7">RAKUTEN TV</a></li>\n                        <li><a class="dropdown-item" href="#scrollspyHeading8">PARAMOUNT CHANNEL</a></li>\n                    </ul>\n                </li>\n            </li>\n             ${s()?"":'\n      <li class="nav-item">\n      <a class="nav-link" href="#/login">Login</a>\n    </li>\n    '}\n    ${s()?"":'\n    <li class="nav-item">\n    <a class="nav-link" href="#/register">Sign Up</a>\n  </li>\n  '}\n  ${s()?'\n        <li class="nav-item">\n          <a class="nav-link"  href="#/logout">Logout</a>\n        </li>\n        <li class="nav-item">\n        <a class="nav-link"  href="#/profile">Profile</a>\n      </li>\n   \n      <li class="nav-item">\n        <a class="nav-link" href="#" id="navbarDropdownMenuLink" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\n          <img id="avatar_navbar" src="" width="30" height="30" class="rounded-circle">\n        </a>\n      </li>   \n      ':""}\n      </ul>\n      <form class="d-flex" role="search">\n        <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">\n        <button class="btn btn-outline-success" type="submit">Search</button>\n      </form>\n    </div>\n  </div>\n  </nav>\n  `,s()&&i().then((n=>{n=n[0],console.log(n),e.querySelector("#avatar_navbar").src=n.avatar_blob})),e}());let n=document.createElement("div");n.id="main",n.classList.add("container"),e.append(n),d(window.location.hash),e.append(function(){let e=document.createElement("div");return e.id="footer",e.classList.add("container"),e.innerHTML='<div class="container my-5">\n  <footer class="text-center text-lg-start text-white" style="background-color: #1c2331">          \n    <section class="d-flex justify-content-between p-4" style="background-color: #6351ce">\n      <div class="me-5">\n        <span> </span>\n      </div>\n      <div>\n        <a href="" class="text-white me-4">\n          <i class="fab fa-facebook-f"></i>\n        </a>\n        <a href="" class="text-white me-4">\n          <i class="fab fa-twitter"></i>\n        </a>\n        <a href="" class="text-white me-4">\n          <i class="fab fa-google"></i>\n        </a>\n        <a href="" class="text-white me-4">\n          <i class="fab fa-instagram"></i>\n        </a>\n        <a href="" class="text-white me-4">\n          <i class="fab fa-linkedin"></i>\n        </a>\n        <a href="" class="text-white me-4">\n          <i class="fab fa-github"></i>\n        </a>\n      </div>\n    </section>\n    <section class="">\n      <div class="container text-center text-md-start mt-5">\n        <div class="row mt-3">\n          <div class="col-md-3 col-lg-4 col-xl-3 mx-auto mb-4">\n            <h6 class="text-uppercase fw-bold">Company name</h6>\n            <hr class="mb-4 mt-0 d-inline-block mx-auto" style="width: 60px; background-color: #7c4dff; height: 2px"/>\n            <p>\n              Here you can use rows and columns to organize your footer\n              content. Lorem ipsum dolor sit amet, consectetur adipisicing\n              elit.\n            </p>\n          </div>\n          <div class="col-md-2 col-lg-2 col-xl-2 mx-auto mb-4">\n            <h6 class="text-uppercase fw-bold">Products</h6>\n            <hr class="mb-4 mt-0 d-inline-block mx-auto" style="width: 60px; background-color: #7c4dff; height: 2px"\n                />\n            <p>\n              <a href="#!" class="text-white">MDBootstrap</a>\n            </p>\n            <p>\n              <a href="#!" class="text-white">MDWordPress</a>\n            </p>\n            <p>\n              <a href="#!" class="text-white">BrandFlow</a>\n            </p>\n            <p>\n              <a href="#!" class="text-white">Bootstrap Angular</a>\n            </p>\n          </div>\n          <div class="col-md-3 col-lg-2 col-xl-2 mx-auto mb-4">\n            <h6 class="text-uppercase fw-bold">Useful links</h6>\n            <hr class="mb-4 mt-0 d-inline-block mx-auto" style="width: 60px; background-color: #7c4dff; height: 2px"/>\n            <p>\n              <a href="#!" class="text-white">Your Account</a>\n            </p>\n            <p>\n              <a href="#!" class="text-white">Become an Affiliate</a>\n            </p>\n            <p>\n              <a href="#!" class="text-white">Shipping Rates</a>\n            </p>\n            <p>\n              <a href="#!" class="text-white">Help</a>\n            </p>\n          </div>\n          <div class="col-md-4 col-lg-3 col-xl-3 mx-auto mb-md-0 mb-4">\n            <h6 class="text-uppercase fw-bold">Contact</h6>\n            <hr class="mb-4 mt-0 d-inline-block mx-auto" style="width: 60px; background-color: #7c4dff; height: 2px"/>\n            <p><i class="fas fa-home mr-3"></i> New York, NY 10012, US</p>\n            <p><i class="fas fa-envelope mr-3"></i> info@example.com</p>\n            <p><i class="fas fa-phone mr-3"></i> + 01 234 567 88</p>\n            <p><i class="fas fa-print mr-3"></i> + 01 234 567 89</p>\n          </div>\n        </div>\n      </div>\n    </section>\n    \n    <div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0.2)">\n      © 2020 Copyright:\n      <a class="text-white" href="https://mdbootstrap.com/">MDBootstrap.com</a>\n    </div>\n  </footer>\n</div>',e}()),window.addEventListener("hashchange",(function(){d(window.location.hash)}))}))})();